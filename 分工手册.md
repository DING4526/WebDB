# 抗战胜利80周年数据库项目 · 分工与开发指导（组员版）

## 0. 这个项目要做成什么样

我们做的是一个 **抗战胜利80周年主题的数据库驱动网站**，主线是：

- **前台**：展示为主
	- 时间轴（事件列表）→ 事件详情（含关联人物）
	- 人物库（人物卡片墙）→ 人物详情（含参与事件）
	- 留言板（提交留言，展示已审核留言）
- **后台**：管理为主（组长负责）
	- 事件/人物 CRUD、事件-人物关联维护
	- 留言审核（通过/拒绝/删除）
	- 演示数据导入

目标不是大而全，而是：
 ✅ 数据库关系清晰（事件↔人物多对多）
 ✅ 前后台能跑通、页面能演示
 ✅ 分工明确、冲突少、按时交付

------

## 1. 项目结构你需要先看懂（Yii2 基础）

Yii2 是典型 MVC 框架：

- **M（Model）模型**：对应数据库表（ActiveRecord），比如 `WarEvent`、`WarPerson`
- **V（View）视图**：页面模板（PHP + HTML），比如 `frontend/views/timeline/index.php`
- **C（Controller）控制器**：路由入口，负责取数据→渲染视图，比如 `TimelineController`

### 目录快速认识

- `console/migrations/`：数据库迁移脚本（建表用）
- `common/models/`：模型（ActiveRecord + 关系方法），**由组长统一维护**
- `backend/`：后台（管理端），**组长独占维护**
- `frontend/`：前台（展示端），**组员各负责一条线**

### 路由怎么理解

一般是：`/controller/action`
 例如：

- `/timeline/index` → `frontend/controllers/TimelineController::actionIndex()`
- `/person/view?id=3` → `PersonController::actionView($id)`

------

## 2. 基本开发逻辑（你写页面时遵循这个顺序）

每条业务线都按同一个套路走：

1. 确认数据库已有表（组长负责迁移）
2. controller 写查询（ActiveRecord）
3. 把结果丢给 view 渲染
4. view 用 Bootstrap 做“可看”的展示
5. 最后再补筛选/分页/细节

> 组员只做“前台展示 + 前台提交（留言）”，**不要碰后台/模型/迁移**。

------

## 3. 数据从哪里来（你们现在的策略）

**已经通过migrants写入了若干初始化数据，也可以在后端手动增删改**

你写前台时，只需要假设这些表/字段存在即可：

- `war_event`：事件（title/event_date/summary/content/status…）
- `war_person`：人物（name/role_type/intro/biography/status…）
- `war_event_person`：事件-人物关联
- `war_message`：留言（nickname/content/status…）

------

## 4. 分工方案（你只需要看你负责的那条线）

## 👑 组长（仅后台负责人）

**只负责：backend + models + migrations + 演示数据 + 最终集成**
 其他人不要改这些目录，避免冲突。

------

## 🧭 组员A：前端【事件线 / 时间轴】

### 你要交付的页面

1. **时间轴列表**：`/timeline/index`

- 按时间倒序展示事件
- 每条显示：日期 / 标题 / 摘要 / “查看详情”
- 可选：按阶段/年份筛选（有就加分，没有也能交）

1. **事件详情**：`/timeline/view?id=`

- 显示：标题、时间、地点、正文
- 显示关联人物：人物卡片（最少显示姓名+身份）

### 你允许修改的文件范围（严格遵守）

```
frontend/controllers/TimelineController.php
frontend/views/timeline/*
```

### 完成标准（验收）

- 列表能出数据
- 点击能进详情页
- 详情页能看到关联人物（至少名字）

------

## 👤 组员B：前端【人物线 / 人物库】

### 你要交付的页面

1. **人物列表**：`/person/index`

- 卡片墙或列表均可
- 卡片显示：姓名 / 身份 / 简介
- 点击进入详情

1. **人物详情**：`/person/view?id=`

- 展示：姓名、身份、生平简介
- 展示参与事件列表（按时间倒序）

### 你允许修改的文件范围

```
frontend/controllers/PersonController.php
frontend/views/person/*
```

### 完成标准（验收）

- 人物列表能出数据
- 详情页能看到“参与事件列表”

------

## 💬 组员C：前端【留言板线】

### 你要交付的页面

1. **留言墙**：`/message/index`

- 列出留言（只展示 status=通过 的）
- 展示：昵称、内容、时间（时间没有就先不显示）

1. **提交留言**：`/message/create`（或 index 里直接表单提交也行）

- 表单字段：nickname、content
- 提交后提示：**“已提交，等待审核”**
- 不需要登录也能留言（若你们项目设定要登录再说）

### 你允许修改的文件范围

```
frontend/controllers/MessageController.php
frontend/views/message/*
```

### 完成标准（验收）

- 能提交留言（入库）
- 留言墙只显示审核通过的留言

------

## 5. 协作规则（减少冲突的关键）

这几条必须执行，不执行就会最后一天爆炸：

1. **后台目录只有组长改**

- `backend/*`、`common/models/*`、`console/migrations/*` 都别动
	 （除非组长点名让你改）

1. **每个组员只改自己 controller + views 目录**

- 不跨线改别人的 controller/view

1. **`frontend/views/layouts/main.php` 指定 1 人维护**

- 这文件最容易冲突
	 建议：让“事件线”维护 layout（或你们指定另一个人），其他人不要碰

1. **UI 风格优先统一，不要各搞一套**

- 用 Bootstrap 3 的 panel/card/table，少写全局 CSS
- 页面 CSS 尽量写在各自 view 里（局部 class），避免污染全站

------

## 6. 推荐的工作流程（不会乱）

你们可以不用复杂 Git 流程，但至少遵守：

- 每个人建自己的分支开发：
	- `feat-frontend-timeline`
	- `feat-frontend-person`
	- `feat-frontend-message`
- 开发完成后提 PR 给组长/或负责合并的人
- 不要多人同时改 layout

------

# 最后一句话（给组员的行动指令）

**你只需要：在你负责的 controller 里把数据查出来，丢给 view 用 Bootstrap 展示出来。**
 不要碰后台和模型，遇到数据表字段/关系问题就找组长。
